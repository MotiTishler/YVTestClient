{"ast":null,"code":"import * as i0 from \"@angular/core\";\nimport * as i1 from \"src/app/services/tickets.service\";\nimport * as i2 from \"@angular/material/snack-bar\";\nimport * as i3 from \"@angular/material/button\";\nimport * as i4 from \"@angular/material/icon\";\nimport * as i5 from \"@angular/material/tabs\";\nexport class TicketsAreaComponent {\n  constructor(ticketsService, sneakBar) {\n    this.ticketsService = ticketsService;\n    this.sneakBar = sneakBar;\n    this.amount = 1;\n    this.curDate = new Date().toLocaleDateString();\n    this.showSneakBar = msg => {\n      this.sneakBar.open(msg, 'x', {\n        duration: 2000\n      });\n    };\n  }\n  ngOnInit() {\n    this.askForList();\n    // refresh list every 10 minutes\n    // in the real world - we'll do it in the server side using web socket\n    //////     setInterval(this.askForList, 10*60*1000);\n  }\n\n  askForList() {\n    this.ticketsService.askForList().subscribe(res => {\n      console.log(res);\n      //assign res to ticketsService        \n      this.ticketsService.luz = res;\n    }, err => {\n      console.log(err);\n      //in real world call an error handler\n    });\n  }\n\n  orderTickets() {\n    if (!this.ticketsService.currentTime) this.showSneakBar('לא בחרת שעת כניסה');else if (this.amount <= 0) this.showSneakBar('לא בחרת מספר מבקרים');else if (this.ticketsService.currentTime.isClosed) this.showSneakBar('המוזיאון סגור בשעה זו');else if (this.ticketsService.currentTime.availablePlaces == 0) this.showSneakBar('אזלו הכרטיסים לשעה זו');else if (this.ticketsService.currentTime.availablePlaces < this.amount) this.showSneakBar('מספר הכרטיסים המבוקש גדול מדי');else {\n      this.ticketsService.orderTickets({\n        startTime: this.ticketsService.currentTime.startTime,\n        amount: this.amount\n      }).subscribe(res => {\n        if (res.amount > 0) {\n          this.showSneakBar(`הזמנת ${res.amount} כרטיסים לשעה ${res.startTime} נקלטה בהצלחה`);\n          this.ticketsService.currentTime.availablePlaces -= res.amount;\n          this.ticketsService.clearCurrentTime();\n        } else {\n          this.showSneakBar('לצערנו, הזמנת הכרטיסים נכשלה.');\n          // ----> advanced: show different message for each error code <--------\n        }\n      }, err => {\n        console.log(err);\n        //in real world call an error handler\n      });\n    }\n  }\n  static #_ = this.ɵfac = function TicketsAreaComponent_Factory(t) {\n    return new (t || TicketsAreaComponent)(i0.ɵɵdirectiveInject(i1.TicketsService), i0.ɵɵdirectiveInject(i2.MatSnackBar));\n  };\n  static #_2 = this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: TicketsAreaComponent,\n    selectors: [[\"app-tickets-area\"]],\n    decls: 32,\n    vars: 2,\n    consts: [[1, \"amount\"], [\"mat-icon-button\", \"\", 3, \"click\"], [1, \"date\"], [1, \"times\"], [\"label\", \"\\u05D1\\u05D5\\u05E7\\u05E8\"], [\"label\", \"\\u05E6\\u05D4\\u05E8\\u05D9\\u05DD\"], [\"label\", \"\\u05D0\\u05D7\\u05E8\\u05D9 \\u05D4\\u05E6\\u05D4\\u05E8\\u05D9\\u05DD\"], [1, \"buttons-area\"], [\"mat-flat-button\", \"\", 3, \"click\"], [\"mat-flat-button\", \"\", \"color\", \"primary\", 3, \"click\"]],\n    template: function TicketsAreaComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"h2\");\n        i0.ɵɵtext(1, \"\\u05E4\\u05E8\\u05D8\\u05D9 \\u05D4\\u05E1\\u05D9\\u05D5\\u05E8\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(2, \"div\", 0)(3, \"h3\");\n        i0.ɵɵtext(4, \"\\u05DE\\u05E1\\u05E4\\u05E8 \\u05DE\\u05D1\\u05E7\\u05E8\\u05D9\\u05DD: \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(5, \"button\", 1);\n        i0.ɵɵlistener(\"click\", function TicketsAreaComponent_Template_button_click_5_listener() {\n          return ctx.amount = ctx.amount + 1;\n        });\n        i0.ɵɵelementStart(6, \"mat-icon\");\n        i0.ɵɵtext(7, \"add_circle_outline\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(8, \"h3\");\n        i0.ɵɵtext(9);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(10, \"button\", 1);\n        i0.ɵɵlistener(\"click\", function TicketsAreaComponent_Template_button_click_10_listener() {\n          return ctx.amount = ctx.amount > 1 ? ctx.amount - 1 : 1;\n        });\n        i0.ɵɵelementStart(11, \"mat-icon\");\n        i0.ɵɵtext(12, \"remove_circle_outline\");\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelementStart(13, \"h3\");\n        i0.ɵɵtext(14, \"\\u05EA\\u05D0\\u05E8\\u05D9\\u05DA: \");\n        i0.ɵɵelementStart(15, \"span\", 2);\n        i0.ɵɵtext(16);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(17, \"div\", 3)(18, \"h3\");\n        i0.ɵɵtext(19, \"\\u05E9\\u05E2\\u05EA \\u05D4\\u05DB\\u05E0\\u05D9\\u05E1\\u05D4 \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(20, \"mat-tab-group\")(21, \"mat-tab\", 4);\n        i0.ɵɵtext(22, \" Content 1 \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(23, \"mat-tab\", 5);\n        i0.ɵɵtext(24, \" Content 2 \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(25, \"mat-tab\", 6);\n        i0.ɵɵtext(26, \" Content 3 \");\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelementStart(27, \"div\", 7)(28, \"button\", 8);\n        i0.ɵɵlistener(\"click\", function TicketsAreaComponent_Template_button_click_28_listener() {\n          return ctx.ticketsService.clearCurrentTime();\n        });\n        i0.ɵɵtext(29, \"\\u05D1\\u05D9\\u05D8\\u05D5\\u05DC\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(30, \"button\", 9);\n        i0.ɵɵlistener(\"click\", function TicketsAreaComponent_Template_button_click_30_listener() {\n          return ctx.orderTickets();\n        });\n        i0.ɵɵtext(31, \"\\u05D4\\u05DE\\u05E9\\u05DA >\");\n        i0.ɵɵelementEnd()();\n      }\n      if (rf & 2) {\n        i0.ɵɵadvance(9);\n        i0.ɵɵtextInterpolate(ctx.amount);\n        i0.ɵɵadvance(7);\n        i0.ɵɵtextInterpolate1(\" \", ctx.curDate, \"\");\n      }\n    },\n    dependencies: [i3.MatButton, i4.MatIcon, i5.MatTabGroup, i5.MatTab],\n    styles: [\".amount[_ngcontent-%COMP%]{\\r\\n    display: flex;\\r\\n    flex-direction: row;\\r\\n}\\r\\n\\r\\nmat-tab[_ngcontent-%COMP%]{\\r\\n    border: 2px solid yellow;\\r\\n}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3NyYy9hcHAvY29tcG9uZW50cy90aWNrZXRzLWFyZWEvdGlja2V0cy1hcmVhLmNvbXBvbmVudC5jc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7SUFDSSxhQUFhO0lBQ2IsbUJBQW1CO0FBQ3ZCOztBQUVBO0lBQ0ksd0JBQXdCO0FBQzVCIiwic291cmNlc0NvbnRlbnQiOlsiLmFtb3VudHtcclxuICAgIGRpc3BsYXk6IGZsZXg7XHJcbiAgICBmbGV4LWRpcmVjdGlvbjogcm93O1xyXG59XHJcblxyXG5tYXQtdGFie1xyXG4gICAgYm9yZGVyOiAycHggc29saWQgeWVsbG93O1xyXG59Il0sInNvdXJjZVJvb3QiOiIifQ== */\"]\n  });\n}","map":{"version":3,"names":["TicketsAreaComponent","constructor","ticketsService","sneakBar","amount","curDate","Date","toLocaleDateString","showSneakBar","msg","open","duration","ngOnInit","askForList","subscribe","res","console","log","luz","err","orderTickets","currentTime","isClosed","availablePlaces","startTime","clearCurrentTime","_","i0","ɵɵdirectiveInject","i1","TicketsService","i2","MatSnackBar","_2","selectors","decls","vars","consts","template","TicketsAreaComponent_Template","rf","ctx","ɵɵelementStart","ɵɵtext","ɵɵelementEnd","ɵɵlistener","TicketsAreaComponent_Template_button_click_5_listener","TicketsAreaComponent_Template_button_click_10_listener","TicketsAreaComponent_Template_button_click_28_listener","TicketsAreaComponent_Template_button_click_30_listener","ɵɵadvance","ɵɵtextInterpolate","ɵɵtextInterpolate1"],"sources":["C:\\Users\\User\\Documents\\YVTest\\YV-ng-Client\\src\\app\\components\\tickets-area\\tickets-area.component.ts","C:\\Users\\User\\Documents\\YVTest\\YV-ng-Client\\src\\app\\components\\tickets-area\\tickets-area.component.html"],"sourcesContent":["import { Component, OnInit } from '@angular/core';\nimport { MatSnackBar } from '@angular/material/snack-bar';\nimport { Order } from 'src/app/interfaces/order';\nimport { TicketsService } from 'src/app/services/tickets.service';\n\n@Component({\n  selector: 'app-tickets-area',\n  templateUrl: './tickets-area.component.html',\n  styleUrls: ['./tickets-area.component.css']\n})\nexport class TicketsAreaComponent implements OnInit {\n\n  public amount:number = 1;\n  public curDate:string = new Date().toLocaleDateString();\n\n  constructor(\n    public ticketsService:TicketsService,\n    private sneakBar:MatSnackBar\n  ) { }\n\n  ngOnInit(): void {\n    this.askForList();\n\n    // refresh list every 10 minutes\n    // in the real world - we'll do it in the server side using web socket\n    \n    \n    //////     setInterval(this.askForList, 10*60*1000);\n  }\n\n  askForList(){\n    this.ticketsService.askForList().subscribe(\n      (res:any)=>{\n        console.log(res);\n\n        //assign res to ticketsService        \n        this.ticketsService.luz = res;\n      },\n      (err:any)=>{\n        console.log(err);\n          //in real world call an error handler\n      }\n    );\n\n\n  }\n\n\n  orderTickets(){\n    if (!this.ticketsService.currentTime) this.showSneakBar('לא בחרת שעת כניסה');\n    else if (this.amount <= 0) this.showSneakBar('לא בחרת מספר מבקרים');\n    else if (this.ticketsService.currentTime.isClosed) this.showSneakBar('המוזיאון סגור בשעה זו');\n    else if (this.ticketsService.currentTime.availablePlaces == 0) this.showSneakBar('אזלו הכרטיסים לשעה זו');\n    else if (this.ticketsService.currentTime.availablePlaces < this.amount) this.showSneakBar('מספר הכרטיסים המבוקש גדול מדי');\n    else {\n      this.ticketsService.orderTickets({startTime:this.ticketsService.currentTime.startTime , amount:this.amount}).subscribe(\n        (res:Order)=>{\n\n          if (res.amount > 0) {\n            this.showSneakBar(`הזמנת ${ res.amount } כרטיסים לשעה ${ res.startTime } נקלטה בהצלחה`);\n            this.ticketsService.currentTime.availablePlaces -= res.amount;\n            this.ticketsService.clearCurrentTime();\n          }\n          else {\n            this.showSneakBar('לצערנו, הזמנת הכרטיסים נכשלה.');\n            // ----> advanced: show different message for each error code <--------\n          }\n\n        },\n        (err:any)=>{\n          console.log(err);\n          //in real world call an error handler\n        }\n      );\n    }\n  }\n\n  private showSneakBar = (msg:string)=>{this.sneakBar.open(msg, 'x', { duration: 2000 });}\n  \n\n}\n","<h2>פרטי הסיור</h2>\n\n<div class=\"amount\">\n    <h3>מספר מבקרים: </h3>\n    <button mat-icon-button (click)=\"this.amount = this.amount+1\"><mat-icon>add_circle_outline</mat-icon></button>\n    <h3>{{ this.amount }}</h3>\n    <button mat-icon-button (click)=\"this.amount = (this.amount>1)? this.amount-1:1\"><mat-icon>remove_circle_outline</mat-icon></button>\n</div> \n\n<h3>תאריך: <span class=\"date\"> {{ this.curDate }}</span></h3>\n\n<div class=\"times\">\n    <h3>שעת הכניסה </h3>\n    <mat-tab-group>\n        <mat-tab label=\"בוקר\"> Content 1 </mat-tab>\n        <mat-tab label=\"צהרים\"> Content 2 </mat-tab>\n        <mat-tab label=\"אחרי הצהרים\"> Content 3 </mat-tab>\n    </mat-tab-group>\n</div>\n<div class=\"buttons-area\">\n    <button mat-flat-button\n            (click)=\"this.ticketsService.clearCurrentTime();\"\n    >ביטול</button>\n    <button mat-flat-button \n            color=\"primary\"\n            (click)=\"orderTickets()\"\n    >המשך ></button>\n</div>\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}